import{u as A,k as S,c,d as u,e,i as B,t as p,r as n,o as z,v as T,z as V,B as N,F as y,h as w,s as $}from"./index-CMPOgCmU.js";import{S as f,b as q,c as x}from"./api-F9C-BKG7.js";import{_ as M}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{P as U}from"./Page-CCejXslC.js";import"./axios-Bo0ATomq.js";const E={class:"article-item card p-0"},F={class:"row"},G={class:"col-md-1"},R=["src"],j={class:"col-md-8"},L={class:"card-body"},O={class:"card-text"},W={class:"card-text"},H={class:"card-text"},J="/v1/articles",K={__name:"ArticleItem",props:["article"],emits:"articleDeleted",setup(d,{emit:m}){const v=A(),l="https://xiaoqingblog-xiaoqingblog.azuremicroservices.io/xiaoqingblog/images",o=S(()=>`${l}${i.article.articleThumbnailImagePath}`),i=d,a=m,g=()=>{v.push({name:"articlesEdit",params:{id:i.article.articleId}})},r=async()=>{f.fire({title:"刪除?",text:"確定要刪除這篇文章嗎?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"確定",cancelButtonText:"取消"}).then(async h=>{h.isConfirmed&&((await q(`${J}/${i.article.articleId}`,v)).status==204?f.fire({title:"刪除!",text:"刪除成功",icon:"success"}).then(()=>{a("articleDeleted","")}):f.fire({title:"錯誤",text:"刪除失敗",icon:"error"}).then(()=>{a("articleDeleted","")}))})};return(h,_)=>(c(),u("div",E,[e("div",F,[e("div",G,[o.value?(c(),u("img",{key:0,src:o.value,class:"img-fluid",alt:"Article Image"},null,8,R)):B("",!0)]),e("div",j,[e("div",L,[e("p",O,"文章標題: "+p(d.article.articleTitle),1),e("p",W,"文章類別: "+p(d.article.articleClass.articleClassName),1),e("p",H,"發文日期: "+p(d.article.articleDate),1)])]),e("div",{class:"col-md-3 d-flex justify-content-end align-items-center mt-2"},[e("button",{class:"btn btn-primary mx-2",onClick:g},"修改"),e("button",{class:"btn btn-danger mx-2",onClick:r},"刪除")])])]))}},Q=M(K,[["__scopeId","data-v-c248f831"]]),X=e("option",{value:"0"},"所有分類",-1),Y=["value"],b="/v1/articles",Z="/v1/articleclasses",k=10,le={__name:"ArticlesView",setup(d){const m=A(),v=n([]),l=n(1),o=n(0),i=n([]),a=n("0"),g=n(!1);z(()=>{r(),C()});const r=async()=>{let t=null;a.value==0?t=await x(`${b}?page=${l.value-1}&size=${k}`,m):t=await x(`${b}/class/${a.value}?page=${l.value-1}&size=${k}`,m),v.value=t.data.content,o.value=t.data.totalPages,D()},h=()=>{r()},_=async t=>{t>=1&&t<=o.value&&(l.value=t,await r())},C=async()=>{const t=await x(Z,m);i.value=t.data},I=()=>{console.log(a.value),l.value=1,r()},D=()=>{T(()=>{g.value=!0})};return(t,P)=>(c(),u("div",null,[V(e("select",{"onUpdate:modelValue":P[0]||(P[0]=s=>a.value=s),onChange:I},[X,(c(!0),u(y,null,w(i.value,s=>(c(),u("option",{key:s.articleClassId,value:s.articleClassId},p(s.articleClassName),9,Y))),128))],544),[[N,a.value]]),(c(!0),u(y,null,w(v.value,s=>(c(),$(Q,{key:s.id,article:s,onArticleDeleted:h},null,8,["article"]))),128)),g.value?(c(),$(U,{key:0,currentPage:l.value,totalPages:o.value,changePage:_},null,8,["currentPage","totalPages"])):B("",!0)]))}};export{le as default};
